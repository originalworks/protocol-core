name: Create Owen Release

on:
  push:
    tags:
      - "owen@*"

jobs:
  debug:
    runs-on: ubuntu-latest
    steps:
      - name: Debug
        run: |
          if [[ -z "$SENTRY_ORG" ]]; then
            echo "❌ SENTRY_ORG is not set!"
          else
            echo "✅ SENTRY_ORG is set!"
          fi
        env:
          SENTRY_ORG: ${{ secrets.SENTRY_ORG }}
        
  release:
    uses: ./.github/workflows/_release-template.yml
    with:
      tag: ${{ github.ref }}

  deploy:
    needs: release
    uses: ./.github/workflows/_deploy-owen-template.yml
    with:
      env: "stage"
      run_id: ${{ github.run_id }}
    secrets: inherit